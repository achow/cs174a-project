<html>
    <head>
        <title>pacman!</title>
        <style>
            body, html { width: 100%; height: 100%; margin: 0;}
        </style>
    </head>

    <body>
        <!-- library -->
        <script src="underscore/underscore.js"></script>
        <script src="def.js/def.js"></script>

        <script src="gl-matrix/common.js"></script>
        <script src="gl-matrix/mat4.js"></script>
        <script src="gl-matrix/mat3.js"></script>

        <script src="gl-matrix/vec4.js"></script>
        <script src="gl-matrix/vec3.js"></script>
        <script src="gl-matrix/vec2.js"></script>

        <!-- scene -->
        <script src="canvas.js"></script>
        <script src="map.data.js"></script>
        <script src="model.js"></script>
        <script src="world.js"></script>
        <script src="camera.js"></script>

        <!-- class (must be placed in order) -->
        <script src="position.js"></script>
        <script src="color.js"></script>
        <script src="object.js"></script>
        <script src="actor.js"></script>
        <script src="monster.js"></script>
        <script src="pacman.js"></script>
        <script src="block.js"></script>

        <!-- buffer -->
        <script src="sphere.buffer.js"></script>
        <script src="cube.buffer.js"></script>

        <!-- test cases -->
        <script src="test.js"></script>

        <!-- fragment shader-->
        <script id="shader-fs" type="x-shader/x-fragment">
            precision mediump float;
            varying vec3 vLight;
            //uniform sampler2D uSampler;
            //varying vec2 vTextureCoord;

            void main(void) {
                //gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));
                gl_FragColor = vec4(vLight, 1);
            }
        </script>

        <!-- vertex shader-->
        <script id="shader-vs" type="x-shader/x-vertex">
            attribute vec4 aPosition;
            attribute vec3 aNormal;
            //attribute vec2 aTextureCoord;

            //varying vec2 vTextureCoord;

            uniform mat4 uWorld;
            uniform mat4 uView;
            uniform mat4 uPerspective;
            uniform vec3 uLightPosition;
            varying vec3 vLight;

            void main(void) {
                vec4 worldPosition = uWorld * aPosition;
                gl_Position = uPerspective * uView * worldPosition;

                vec3 lightDirection = normalize(uLightPosition - worldPosition.xyz);

                float directionalLightWeighting = max(dot((uWorld * vec4(aNormal, 1)).xyz, lightDirection), 0.0);
                vLight = vec3(1, 1, 1) * directionalLightWeighting;
                //vTextureCoord = aTextureCoord;
            }
        </script>

        <canvas id="game-canvas" style="border: none;"></canvas>
        <canvas id="minimap" style="border: none; position: absolute; bottom: 1em; right: 1em;"></canvas>
        <script src="gl.js"></script>
        <script src="canvas.data.js"></script>
        <script>
            var game = document.getElementById("game-canvas");
            game.width = document.width;
            game.height = document.height;

            var minimap = document.getElementById("minimap");
            minimap.width = 300;
            minimap.height = 200;


            GL = new GL(CANVAS_DATA);
            // sync minimap
            GL.canvas[0].world.camera = new Camera();
            GL.canvas[0].world.camera.position.z = 15;
            GL.canvas[0].world.lightPosition.z = 1000;
            GL.canvas[0].world.renderList = GL.canvas[1].world.renderList;
            GL.canvas[0].world.animateList = GL.canvas[1].world.animateList;
            for(var i in window) {
                //console.log(i);
            }

        </script>
    </body>

</html>

